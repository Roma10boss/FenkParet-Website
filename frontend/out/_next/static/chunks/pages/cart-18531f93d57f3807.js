(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[190],{8086:function(e,r,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/cart",function(){return s(7917)}])},7917:function(e,r,s){"use strict";s.r(r),s.d(r,{default:function(){return p}});var a=s(567),t=s(5893),n=s(7294),i=s(1557),o=s(5675),l=s.n(o),d=e=>{let{item:r}=e,{updateQuantity:s,removeFromCart:a}=(0,i.j)();return(0,t.jsxs)("div",{className:"flex items-center justify-between border-b border-gray-200 dark:border-gray-700 py-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)("div",{className:"relative w-20 h-20 flex-shrink-0",children:(0,t.jsx)(l(),{src:r.image,alt:r.name,layout:"fill",objectFit:"cover",className:"rounded-md"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold text-lg",children:r.name}),r.variant&&(0,t.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Variant: ",r.variant.name]}),(0,t.jsxs)("p",{className:"text-gray-800 dark:text-gray-200",children:["$",r.price.toFixed(2)]})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)("input",{type:"number",min:"1",value:r.quantity,onChange:e=>{let a=parseInt(e.target.value,10);isNaN(a)||s(r.id,a)},className:"w-16 px-2 py-1 border rounded-md text-center dark:bg-gray-700"}),(0,t.jsx)("button",{onClick:()=>a(r.id),className:"text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-600",children:"Remove"})]})]})},c=s(6501),m=s(1163),u=s(7066),x=s(4155);let h=u.Z.create({baseURL:x.env.NEXT_PUBLIC_BACKEND_URL||"http://localhost:5000/api",withCredentials:!0});h.interceptors.request.use(e=>e,e=>Promise.reject(e)),h.interceptors.response.use(e=>e,e=>(e.response?(console.error("API Error:",e.response.data),console.error("Status:",e.response.status),console.error("Headers:",e.response.headers)):e.request?console.error("API Error: No response received",e.request):console.error("API Error:",e.message),Promise.reject(e)));var p=()=>{let{items:e,getTotals:r,clearCart:s,isEmpty:o}=(0,i.j)(),{subtotal:l,tax:u,shipping:x,total:h,itemCount:p}=r(),[j,v]=(0,n.useState)(""),[f,g]=(0,n.useState)(!1),b=(0,m.useRouter)(),N=async()=>{if(!j.trim()){c.Am.error("Veuillez entrer votre num\xe9ro de confirmation.");return}g(!0);try{let r=localStorage.getItem("token"),t=e.map(e=>({productId:e.id,name:e.name,quantity:e.quantity,price:e.price,variant:e.variant||null})),n=await fetch("".concat("https://fenkparet-backend.onrender.com","/api/orders/place-order-with-confirmation"),{method:"POST",headers:(0,a._)({"Content-Type":"application/json"},r&&{Authorization:"Bearer ".concat(r)}),body:JSON.stringify({cart:t,confirmationNumber:j,language:"fr"})}),i=await n.json();if(!n.ok)throw Error(i.message||"Erreur lors de la commande");c.Am.success("Commande pass\xe9e avec succ\xe8s! Nous v\xe9rifierons votre num\xe9ro de confirmation."),s(),b.push("/user/orders")}catch(e){console.error("Order placement error:",e),c.Am.error(e.message||"Une erreur est survenue lors de la commande.")}finally{g(!1)}};return(0,t.jsx)("div",{className:"container mx-auto p-4",children:o()?(0,t.jsx)("p",{children:"Votre panier est vide. Commencez vos achats!"}):(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[(0,t.jsx)("div",{className:"md:col-span-2",children:e.map(e=>(0,t.jsx)(d,{item:e},e.id))}),(0,t.jsxs)("div",{className:"bg-gray-100 dark:bg-gray-800 p-6 rounded-lg",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"R\xe9sum\xe9 de la commande"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsxs)("span",{children:["Sous-total (",p," ",1===p?"article":"articles",")"]}),(0,t.jsxs)("span",{children:[l.toFixed(2)," HTG"]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Taxes"}),(0,t.jsxs)("span",{children:[u.toFixed(2)," HTG"]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Livraison"}),(0,t.jsxs)("span",{children:[x.toFixed(2)," HTG"]})]}),(0,t.jsxs)("div",{className:"flex justify-between font-bold text-lg",children:[(0,t.jsx)("span",{children:"Total"}),(0,t.jsxs)("span",{children:[h.toFixed(2)," HTG"]})]})]}),(0,t.jsxs)("div",{className:"mt-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Confirmation de paiement"}),(0,t.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Pour compl\xe9ter votre commande, veuillez entrer le num\xe9ro de confirmation qui vous a \xe9t\xe9 fourni. Un administrateur le v\xe9rifiera dans les 48 heures."}),(0,t.jsx)("input",{type:"text",value:j,onChange:e=>v(e.target.value),placeholder:"Entrez le num\xe9ro de confirmation",className:"w-full px-4 py-2 border rounded-md dark:bg-gray-700"})]}),(0,t.jsx)("div",{className:"mt-6",children:(0,t.jsx)("button",{onClick:N,disabled:f||!j,className:"w-full bg-blue-600 text-white py-3 rounded-md hover:bg-blue-700 disabled:bg-gray-400",children:f?"Commande en cours...":"Passer la commande"})})]})]})})}}},function(e){e.O(0,[66,888,774,179],function(){return e(e.s=8086)}),_N_E=e.O()}]);