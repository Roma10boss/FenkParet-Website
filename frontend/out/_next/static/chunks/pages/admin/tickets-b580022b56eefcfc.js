(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[713],{7928:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/tickets",function(){return r(3628)}])},6356:function(e,t,r){"use strict";var s=r(567),o=r(4932),i=r(5893),a=r(7294);r(4410);var n=r(9761);t.Z=e=>{var t,r;let{ticket:l,onClose:c,onSubmit:d}=e,[u,m]=(0,a.useState)({subject:(null==l?void 0:l.subject)||"",description:(null==l?void 0:l.description)||"",customerName:(null==l?void 0:null===(t=l.customer)||void 0===t?void 0:t.name)||"",customerEmail:(null==l?void 0:null===(r=l.customer)||void 0===r?void 0:r.email)||"",status:(null==l?void 0:l.status)||"open",priority:(null==l?void 0:l.priority)||"low",category:(null==l?void 0:l.category)||"other",assignedTo:(null==l?void 0:l.assignedTo)||""}),[p,x]=(0,a.useState)({}),[b,h]=(0,a.useState)(!1),{showSuccess:g,showError:j}=(0,n.V)();(0,a.useEffect)(()=>{if(l){var e,t;m({subject:l.subject||"",description:l.description||"",customerName:(null===(e=l.customer)||void 0===e?void 0:e.name)||"",customerEmail:(null===(t=l.customer)||void 0===t?void 0:t.email)||"",status:l.status||"open",priority:l.priority||"low",category:l.category||"other",assignedTo:l.assignedTo||""})}},[l]);let f=e=>{let{name:t,value:r}=e.target;m(e=>(0,o._)((0,s._)({},e),{[t]:r})),p[t]&&x(e=>(0,o._)((0,s._)({},e),{[t]:""}))},v=()=>{let e={};return u.subject.trim()||(e.subject="Subject is required"),u.description.trim()||(e.description="Description is required"),u.customerName.trim()||(e.customerName="Customer name is required"),u.customerEmail.trim()?/\S+@\S+\.\S+/.test(u.customerEmail)||(e.customerEmail="Customer email is invalid"):e.customerEmail="Customer email is required",x(e),0===Object.keys(e).length},y=async e=>{if(e.preventDefault(),v())try{h(!0);let e=(0,s._)({},u),t=l?"".concat("https://fenkparet-backend.onrender.com","/api/admin/tickets/").concat(l.id):"".concat("https://fenkparet-backend.onrender.com","/api/admin/tickets");if(!(await fetch(t,{method:l?"PUT":"POST",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token")),"Content-Type":"application/json"},body:JSON.stringify(e)})).ok)throw Error("Failed to ".concat(l?"update":"create"," ticket"));g("Ticket ".concat(l?"updated":"created"," successfully")),d()}catch(e){console.error("Error saving ticket:",e),j("Failed to ".concat(l?"update":"create"," ticket. Please try again."))}finally{h(!1)}};return(0,i.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,i.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-11/12 md:w-4/5 lg:w-3/4 xl:w-2/3 shadow-lg rounded-md bg-white max-h-[80vh] overflow-y-auto",children:(0,i.jsxs)("div",{className:"mt-3",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,i.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:l?"Edit Ticket":"Create New Ticket"}),(0,i.jsx)("button",{type:"button",onClick:c,className:"text-gray-400 hover:text-gray-600",children:(0,i.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,i.jsxs)("form",{onSubmit:y,className:"space-y-4",children:[(0,i.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject *"}),(0,i.jsx)("input",{type:"text",name:"subject",value:u.subject,onChange:f,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent ".concat(p.subject?"border-red-300":"border-gray-300"),placeholder:"Enter ticket subject"}),p.subject&&(0,i.jsx)("p",{className:"text-red-500 text-xs mt-1",children:p.subject})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description *"}),(0,i.jsx)("textarea",{name:"description",value:u.description,onChange:f,rows:4,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent ".concat(p.description?"border-red-300":"border-gray-300"),placeholder:"Enter detailed description of the issue"}),p.description&&(0,i.jsx)("p",{className:"text-red-500 text-xs mt-1",children:p.description})]}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer Name *"}),(0,i.jsx)("input",{type:"text",name:"customerName",value:u.customerName,onChange:f,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent ".concat(p.customerName?"border-red-300":"border-gray-300"),placeholder:"Customer's full name"}),p.customerName&&(0,i.jsx)("p",{className:"text-red-500 text-xs mt-1",children:p.customerName})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer Email *"}),(0,i.jsx)("input",{type:"email",name:"customerEmail",value:u.customerEmail,onChange:f,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent ".concat(p.customerEmail?"border-red-300":"border-gray-300"),placeholder:"Customer's email address"}),p.customerEmail&&(0,i.jsx)("p",{className:"text-red-500 text-xs mt-1",children:p.customerEmail})]})]})]}),(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,i.jsxs)("select",{name:"status",value:u.status,onChange:f,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,i.jsx)("option",{value:"open",children:"Open"}),(0,i.jsx)("option",{value:"in_progress",children:"In Progress"}),(0,i.jsx)("option",{value:"waiting_customer",children:"Waiting for Customer"}),(0,i.jsx)("option",{value:"resolved",children:"Resolved"}),(0,i.jsx)("option",{value:"closed",children:"Closed"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),(0,i.jsxs)("select",{name:"priority",value:u.priority,onChange:f,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,i.jsx)("option",{value:"low",children:"Low"}),(0,i.jsx)("option",{value:"medium",children:"Medium"}),(0,i.jsx)("option",{value:"high",children:"High"}),(0,i.jsx)("option",{value:"urgent",children:"Urgent"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),(0,i.jsxs)("select",{name:"category",value:u.category,onChange:f,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,i.jsx)("option",{value:"technical",children:"Technical Issue"}),(0,i.jsx)("option",{value:"billing",children:"Billing"}),(0,i.jsx)("option",{value:"account",children:"Account"}),(0,i.jsx)("option",{value:"product",children:"Product Inquiry"}),(0,i.jsx)("option",{value:"shipping",children:"Shipping"}),(0,i.jsx)("option",{value:"return",children:"Return/Refund"}),(0,i.jsx)("option",{value:"other",children:"Other"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Assigned To"}),(0,i.jsx)("input",{type:"text",name:"assignedTo",value:u.assignedTo,onChange:f,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Agent Name or ID"})]})]})]}),(0,i.jsxs)("div",{className:"flex justify-end space-x-3 pt-6 border-t",children:[(0,i.jsx)("button",{type:"button",onClick:c,className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",disabled:b,children:"Cancel"}),(0,i.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md text-sm font-medium hover:bg-blue-700 disabled:opacity-50",disabled:b,children:b?"Saving...":l?"Update Ticket":"Create Ticket"})]})]})]})})})}}},function(e){e.O(0,[328,58,216,888,179],function(){return e(e.s=7928)}),_N_E=e.O()}]);