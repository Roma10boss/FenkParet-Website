(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[190],{8086:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/cart",function(){return t(1250)}])},1250:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return g}});var a=t(567),r=t(5893),n=t(7294),c=t(9008),i=t.n(c),l=t(1664),m=t.n(l),d=t(1557),o=t(5675),x=t.n(o),h=e=>{let{item:s}=e,{updateQuantity:t,removeFromCart:a}=(0,d.j)();return(0,r.jsxs)("div",{className:"flex items-center justify-between border-b border-gray-200 dark:border-gray-700 py-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("div",{className:"relative w-20 h-20 flex-shrink-0",children:(0,r.jsx)(x(),{src:s.image,alt:s.name,layout:"fill",objectFit:"cover",className:"rounded-md"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold text-lg",children:s.name}),s.variant&&(0,r.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Variant: ",s.variant.name]}),(0,r.jsxs)("p",{className:"text-gray-800 dark:text-gray-200",children:["$",s.price.toFixed(2)]})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("input",{type:"number",min:"1",value:s.quantity,onChange:e=>{let a=parseInt(e.target.value,10);isNaN(a)||t(s.id,a)},className:"w-16 px-2 py-1 border rounded-md text-center dark:bg-gray-700"}),(0,r.jsx)("button",{onClick:()=>a(s.id),className:"text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-600",children:"Remove"})]})]})},u=t(6501),p=t(1163),j=t(2861),N=t(807),f=t(8654),y=t(5407),b=t(2997),v=t(1429),g=()=>{let{items:e,getTotals:s,clearCart:t,isEmpty:c}=(0,d.j)(),{subtotal:l,tax:o,shipping:x,total:g,itemCount:w}=s(),[k,O]=(0,n.useState)(""),[S,_]=(0,n.useState)(!1),C=(0,p.useRouter)(),Z=async()=>{if(!k.trim()){u.Am.error("Veuillez entrer votre num\xe9ro de confirmation.");return}_(!0);try{let s=localStorage.getItem("token"),r=e.map(e=>({productId:e.id,name:e.name,quantity:e.quantity,price:e.price,variant:e.variant||null})),n=await fetch("".concat("https://fenkparet-backend.onrender.com","/api/orders"),{method:"POST",headers:(0,a._)({"Content-Type":"application/json"},s&&{Authorization:"Bearer ".concat(s)}),body:JSON.stringify({items:r,confirmationNumber:k,language:"fr",totals:{subtotal:l,tax:o,shipping:x,total:g},paymentMethod:"moncash",status:"pending"})});if(n.ok||404!==n.status||(console.log("Primary orders endpoint not found, trying cart endpoint..."),n=await fetch("".concat("https://fenkparet-backend.onrender.com","/api/cart/checkout"),{method:"POST",headers:(0,a._)({"Content-Type":"application/json"},s&&{Authorization:"Bearer ".concat(s)}),body:JSON.stringify({items:r,confirmationNumber:k,language:"fr",totals:{subtotal:l,tax:o,shipping:x,total:g},paymentMethod:"moncash",status:"pending"})})),!n.ok&&404===n.status){console.log("Backend order endpoints not available, creating local order record...");let e={id:"ORDER-"+Date.now(),items:r,confirmationNumber:k,totals:{subtotal:l,tax:o,shipping:x,total:g},status:"pending",createdAt:new Date().toISOString()},s=JSON.parse(localStorage.getItem("localOrders")||"[]");s.push(e),localStorage.setItem("localOrders",JSON.stringify(s)),u.Am.success("Commande enregistr\xe9e localement! Un repr\xe9sentant vous contactera pour confirmer."),t(),C.push("/user/orders");return}let c=await n.json();if(console.log("Order response:",c),!n.ok)throw console.error("Order API error:",n.status,c),Error(c.message||"Server error: ".concat(n.status));u.Am.success("Commande pass\xe9e avec succ\xe8s! Nous v\xe9rifierons votre num\xe9ro de confirmation."),t(),C.push("/user/orders")}catch(e){console.error("Order placement error:",e),u.Am.error(e.message||"Une erreur est survenue lors de la commande.")}finally{_(!1)}};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(i(),{children:[(0,r.jsxs)("title",{children:["Panier - ","Fenkparet"]}),(0,r.jsx)("meta",{name:"description",content:"Votre panier d'achats"})]}),(0,r.jsx)("div",{className:"min-h-screen bg-theme-secondary",children:(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)(m(),{href:"/products",className:"btn-ghost p-2",children:(0,r.jsx)(j.Z,{className:"w-5 h-5"})}),(0,r.jsxs)("h1",{className:"text-3xl font-bold text-theme-primary flex items-center",children:[(0,r.jsx)(N.Z,{className:"w-8 h-8 mr-3 text-accent"}),"Mon Panier"]})]}),!c()&&(0,r.jsxs)("div",{className:"text-theme-secondary",children:[w," ",1===w?"article":"articles"]})]}),c()?(0,r.jsx)("div",{className:"text-center py-16",children:(0,r.jsxs)("div",{className:"bg-theme-primary rounded-2xl shadow-lg p-12 max-w-md mx-auto",children:[(0,r.jsx)(N.Z,{className:"w-24 h-24 text-theme-tertiary mx-auto mb-6"}),(0,r.jsx)("h2",{className:"text-2xl font-bold text-theme-primary mb-4",children:"Votre panier est vide"}),(0,r.jsx)("p",{className:"text-theme-secondary mb-8",children:"D\xe9couvrez notre collection et trouvez quelque chose qui vous pla\xeet !"}),(0,r.jsxs)(m(),{href:"/products",className:"btn-primary inline-flex items-center",children:[(0,r.jsx)(N.Z,{className:"w-5 h-5 mr-2"}),"Commencer mes achats"]})]})}):(0,r.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-8",children:[(0,r.jsx)("div",{className:"xl:col-span-2 space-y-4",children:(0,r.jsxs)("div",{className:"bg-theme-primary rounded-xl shadow-sm border border-theme p-6",children:[(0,r.jsxs)("h2",{className:"text-xl font-semibold text-theme-primary mb-6 flex items-center",children:[(0,r.jsx)(N.Z,{className:"w-5 h-5 mr-2 text-accent"}),"Articles dans votre panier"]}),(0,r.jsx)("div",{className:"space-y-4",children:e.map((s,t)=>(0,r.jsxs)("div",{children:[(0,r.jsx)(h,{item:s}),t<e.length-1&&(0,r.jsx)("hr",{className:"border-theme my-4"})]},s.id))})]})}),(0,r.jsx)("div",{className:"xl:col-span-1",children:(0,r.jsxs)("div",{className:"bg-theme-primary rounded-xl shadow-sm border border-theme p-6 sticky top-8",children:[(0,r.jsxs)("h2",{className:"text-xl font-semibold text-theme-primary mb-6 flex items-center",children:[(0,r.jsx)(f.Z,{className:"w-5 h-5 mr-2 text-accent"}),"R\xe9sum\xe9 de la commande"]}),(0,r.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,r.jsxs)("div",{className:"flex justify-between text-theme-secondary",children:[(0,r.jsxs)("span",{children:["Sous-total (",w," ",1===w?"article":"articles",")"]}),(0,r.jsxs)("span",{className:"font-medium",children:[l.toFixed(2)," HTG"]})]}),(0,r.jsxs)("div",{className:"flex justify-between text-theme-secondary",children:[(0,r.jsx)("span",{children:"Taxes"}),(0,r.jsxs)("span",{className:"font-medium",children:[o.toFixed(2)," HTG"]})]}),(0,r.jsxs)("div",{className:"flex justify-between text-theme-secondary",children:[(0,r.jsxs)("span",{className:"flex items-center",children:[(0,r.jsx)(y.Z,{className:"w-4 h-4 mr-1"}),"Livraison"]}),(0,r.jsxs)("span",{className:"font-medium",children:[x.toFixed(2)," HTG"]})]}),(0,r.jsx)("hr",{className:"border-theme"}),(0,r.jsxs)("div",{className:"flex justify-between text-lg font-bold text-theme-primary",children:[(0,r.jsx)("span",{children:"Total"}),(0,r.jsxs)("span",{className:"text-accent",children:[g.toFixed(2)," HTG"]})]})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold text-theme-primary mb-3 flex items-center",children:[(0,r.jsx)(b.Z,{className:"w-5 h-5 mr-2 text-accent"}),"Confirmation de paiement"]}),(0,r.jsx)("div",{className:"bg-theme-secondary rounded-lg p-4 mb-4",children:(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)(v.Z,{className:"w-5 h-5 text-accent mt-0.5 flex-shrink-0"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-theme-primary font-medium mb-1",children:"Processus de commande s\xe9curis\xe9"}),(0,r.jsx)("p",{className:"text-xs text-theme-secondary",children:"Entrez votre num\xe9ro de confirmation de paiement. Notre \xe9quipe v\xe9rifiera votre paiement dans les 48 heures."})]})]})}),(0,r.jsx)("input",{type:"text",value:k,onChange:e=>O(e.target.value),placeholder:"Num\xe9ro de confirmation",className:"w-full px-4 py-3 border border-theme-border rounded-lg bg-theme-input text-theme-primary placeholder-theme-tertiary focus:outline-none focus:ring-2 focus:ring-accent focus:border-transparent transition-all"})]}),(0,r.jsx)("button",{onClick:Z,disabled:S||!k.trim(),className:"w-full btn-primary py-4 text-lg font-semibold disabled:opacity-50 disabled:cursor-not-allowed transition-all hover:shadow-lg",children:S?(0,r.jsxs)("div",{className:"flex items-center justify-center",children:[(0,r.jsx)("div",{className:"spinner w-5 h-5 mr-2"}),"Commande en cours..."]}):(0,r.jsxs)("div",{className:"flex items-center justify-center",children:[(0,r.jsx)(b.Z,{className:"w-5 h-5 mr-2"}),"Passer la commande"]})}),(0,r.jsx)("div",{className:"mt-6 pt-6 border-t border-theme",children:(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-center",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(b.Z,{className:"w-6 h-6 text-accent mx-auto mb-1"}),(0,r.jsx)("p",{className:"text-xs text-theme-tertiary",children:"Paiement s\xe9curis\xe9"})]}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(y.Z,{className:"w-6 h-6 text-accent mx-auto mb-1"}),(0,r.jsx)("p",{className:"text-xs text-theme-tertiary",children:"Livraison rapide"})]}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(v.Z,{className:"w-6 h-6 text-accent mx-auto mb-1"}),(0,r.jsx)("p",{className:"text-xs text-theme-tertiary",children:"Garanti"})]})]})})]})})]})]})})]})}}},function(e){e.O(0,[216,888,179],function(){return e(e.s=8086)}),_N_E=e.O()}]);