(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[872],{9657:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/user/profile",function(){return t(5415)}])},5415:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return y}});var r=t(567),a=t(4932),n=t(5893),c=t(7294),l=t(9008),o=t.n(l),i=t(1163),m=t(3950),d=t(6483),h=t(3541),u=t(8566),x=t(4874),p=t(7511),f=t(9633),g=t(2490),N=t(1837),j=t(6501),b=t(9274);function y(){let e=(0,i.useRouter)(),{user:s,updateUser:t,changePassword:l,isAuthenticated:y,loading:v}=(0,g.a)(),{theme:w,toggleTheme:_,isDark:k,mounted:P}=(0,N.F)(),C=e=>console.log("Language change:",e),[A,Z]=(0,c.useState)("profile"),[E,S]=(0,c.useState)(!1),[U,L]=(0,c.useState)({current:!1,new:!1,confirm:!1}),[F,q]=(0,c.useState)({firstName:"",lastName:"",email:"",phone:"",address:{street:"",city:"",state:"",postalCode:"",country:"Haiti"}}),[D,M]=(0,c.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),[H,O]=(0,c.useState)({emailNotifications:!0,orderUpdates:!0,promotions:!1,language:"en",theme:w}),I=v||!P;(0,c.useEffect)(()=>{if(!v&&P){if(!y){j.Am.error("You must be logged in to view your profile."),e.push("/auth/login");return}if(s){var t,r,a,n,c,l,o,i,m,d,h;let e=s.firstName||"",u=s.lastName||"";if(!s.firstName&&!s.lastName&&s.name){let t=s.name.split(" ");e=t[0]||"",u=t.slice(1).join(" ")||""}q({firstName:e,lastName:u,email:s.email||"",phone:s.phone||"",address:{street:(null===(t=s.address)||void 0===t?void 0:t.street)||"",city:(null===(r=s.address)||void 0===r?void 0:r.city)||"",state:(null===(a=s.address)||void 0===a?void 0:a.state)||"",postalCode:(null===(n=s.address)||void 0===n?void 0:n.postalCode)||"",country:(null===(c=s.address)||void 0===c?void 0:c.country)||"Haiti"}}),O({emailNotifications:null===(m=null===(l=s.preferences)||void 0===l?void 0:l.emailNotifications)||void 0===m||m,orderUpdates:null===(d=null===(o=s.preferences)||void 0===o?void 0:o.orderUpdates)||void 0===d||d,promotions:null!==(h=null===(i=s.preferences)||void 0===i?void 0:i.promotions)&&void 0!==h&&h,language:"en",theme:w})}}},[s,y,v,P,e,"en",w]);let T=async e=>{e.preventDefault(),S(!0);try{let e={firstName:F.firstName,lastName:F.lastName,phone:F.phone,address:F.address},s=await t(e);s&&s.success?j.Am.success("Profile updated successfully!"):j.Am.error((null==s?void 0:s.error)||"Failed to update profile.")}catch(e){console.error("Error updating profile:",e),j.Am.error("An error occurred while updating profile.")}finally{S(!1)}},X=async e=>{if(e.preventDefault(),D.newPassword!==D.confirmPassword){j.Am.error("New passwords do not match!");return}if(D.newPassword.length<8){j.Am.error("Le mot de passe doit contenir au moins 8 caract\xe8res.");return}if(!/[A-Z]/.test(D.newPassword)){j.Am.error("Le mot de passe doit contenir au moins une lettre majuscule.");return}S(!0);try{let e=await l(D.currentPassword,D.newPassword);e&&e.success?(j.Am.success("Password changed successfully!"),M({currentPassword:"",newPassword:"",confirmPassword:""})):j.Am.error((null==e?void 0:e.error)||"Failed to change password.")}catch(e){console.error("Error changing password:",e),j.Am.error("An error occurred while changing password.")}finally{S(!1)}},z=async e=>{e.preventDefault(),S(!0);try{"en"!==H.language&&C(H.language),H.theme!==w&&_();let e=await t({preferences:{emailNotifications:H.emailNotifications,orderUpdates:H.orderUpdates,promotions:H.promotions,language:H.language,theme:H.theme}});e&&e.success?j.Am.success("Preferences updated successfully!"):j.Am.error((null==e?void 0:e.error)||"user.preferencesUpdateFailed")}catch(e){console.error("Error updating preferences:",e),j.Am.error("error.genericPreferences")}finally{S(!1)}},B=[{id:"profile",name:"user.personalInfo",icon:m.Z},{id:"password",name:"user.changePassword",icon:d.Z},{id:"preferences",name:"user.preferences",icon:h.Z}];return I?(0,n.jsx)(b.h,{message:"loading.profile"}):s?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(o(),{children:[(0,n.jsxs)("title",{children:["user.profile"," | Fenkparet"]}),(0,n.jsx)("meta",{name:"description",content:"user.profileMetaDesc"}),(0,n.jsx)("meta",{name:"robots",content:"noindex, nofollow"})]}),(0,n.jsx)("div",{className:"min-h-screen bg-theme-primary py-8 theme-transition",children:(0,n.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,n.jsxs)("div",{className:"mb-8",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-theme-primary",children:"user.profile"}),(0,n.jsx)("p",{className:"text-theme-secondary mt-2",children:"user.profileManageDesc"})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[(0,n.jsx)("div",{className:"lg:col-span-1",children:(0,n.jsx)("div",{className:"card",children:(0,n.jsxs)("div",{className:"card-body",children:[(0,n.jsxs)("div",{className:"text-center mb-6",children:[(0,n.jsx)("div",{className:"w-20 h-20 bg-theme-secondary rounded-full flex items-center justify-center mx-auto mb-4",children:(0,n.jsx)(m.Z,{className:"w-10 h-10 text-accent"})}),(0,n.jsxs)("h3",{className:"text-lg font-semibold text-theme-primary",children:[F.firstName," ",F.lastName]}),(0,n.jsx)("p",{className:"text-theme-secondary text-sm",children:s.email})]}),(0,n.jsx)("nav",{className:"space-y-2",children:B.map(e=>(0,n.jsxs)("button",{onClick:()=>Z(e.id),className:"w-full flex items-center px-4 py-2 text-left rounded-md transition-colors ".concat(A===e.id?"bg-accent text-accent-contrast":"text-theme-secondary hover:bg-theme-tertiary hover:text-theme-primary"),children:[(0,n.jsx)(e.icon,{className:"w-5 h-5 mr-3"}),e.name]},e.id))})]})})}),(0,n.jsx)("div",{className:"lg:col-span-3",children:(0,n.jsx)("div",{className:"card",children:(0,n.jsxs)("div",{className:"card-body",children:["profile"===A&&(0,n.jsxs)("form",{onSubmit:T,children:[(0,n.jsx)("h2",{className:"text-xl font-semibold text-theme-primary mb-6",children:"user.personalInfo"}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{className:"form-label text-theme-secondary",children:"checkout.firstName"}),(0,n.jsx)("input",{type:"text",className:"form-input",value:F.firstName,onChange:e=>q((0,a._)((0,r._)({},F),{firstName:e.target.value})),required:!0})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{className:"form-label text-theme-secondary",children:"checkout.lastName"}),(0,n.jsx)("input",{type:"text",className:"form-input",value:F.lastName,onChange:e=>q((0,a._)((0,r._)({},F),{lastName:e.target.value})),required:!0})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{className:"form-label text-theme-secondary",children:"checkout.email"}),(0,n.jsx)("input",{type:"email",className:"form-input",value:F.email,onChange:e=>q((0,a._)((0,r._)({},F),{email:e.target.value})),required:!0,readOnly:!0,disabled:!0})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{className:"form-label text-theme-secondary",children:"checkout.phone"}),(0,n.jsx)("input",{type:"tel",className:"form-input",value:F.phone,onChange:e=>q((0,a._)((0,r._)({},F),{phone:e.target.value}))})]}),(0,n.jsxs)("div",{className:"form-group md:col-span-2",children:[(0,n.jsx)("label",{className:"form-label text-theme-secondary",children:"checkout.street"}),(0,n.jsx)("input",{type:"text",className:"form-input",value:F.address.street,onChange:e=>q((0,a._)((0,r._)({},F),{address:(0,a._)((0,r._)({},F.address),{street:e.target.value})}))})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{className:"form-label text-theme-secondary",children:"checkout.city"}),(0,n.jsx)("input",{type:"text",className:"form-input",value:F.address.city,onChange:e=>q((0,a._)((0,r._)({},F),{address:(0,a._)((0,r._)({},F.address),{city:e.target.value})}))})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{className:"form-label text-theme-secondary",children:"checkout.state"}),(0,n.jsx)("input",{type:"text",className:"form-input",value:F.address.state,onChange:e=>q((0,a._)((0,r._)({},F),{address:(0,a._)((0,r._)({},F.address),{state:e.target.value})}))})]})]}),(0,n.jsx)("div",{className:"mt-6",children:(0,n.jsx)("button",{type:"submit",disabled:E,className:"btn-primary",children:E?"common.updating":"user.updateProfile"})})]}),"password"===A&&(0,n.jsxs)("form",{onSubmit:X,children:[(0,n.jsx)("h2",{className:"text-xl font-semibold text-theme-primary mb-6",children:"user.changePassword"}),(0,n.jsxs)("div",{className:"space-y-6 max-w-md",children:[(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{className:"form-label text-theme-secondary",children:"user.currentPassword"}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("input",{type:U.current?"text":"password",className:"form-input pr-10",value:D.currentPassword,onChange:e=>M((0,a._)((0,r._)({},D),{currentPassword:e.target.value})),required:!0}),(0,n.jsx)("button",{type:"button",className:"absolute inset-y-0 right-0 flex items-center pr-3 text-theme-tertiary",onClick:()=>L((0,a._)((0,r._)({},U),{current:!U.current})),children:U.current?(0,n.jsx)(u.Z,{className:"h-5 w-5"}):(0,n.jsx)(x.Z,{className:"h-5 w-5"})})]})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{className:"form-label text-theme-secondary",children:"user.newPassword"}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("input",{type:U.new?"text":"password",className:"form-input pr-10",value:D.newPassword,onChange:e=>M((0,a._)((0,r._)({},D),{newPassword:e.target.value})),required:!0,minLength:"6"}),(0,n.jsx)("button",{type:"button",className:"absolute inset-y-0 right-0 flex items-center pr-3 text-theme-tertiary",onClick:()=>L((0,a._)((0,r._)({},U),{new:!U.new})),children:U.new?(0,n.jsx)(u.Z,{className:"h-5 w-5"}):(0,n.jsx)(x.Z,{className:"h-5 w-5"})})]})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{className:"form-label text-theme-secondary",children:"user.confirmPassword"}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("input",{type:U.confirm?"text":"password",className:"form-input pr-10",value:D.confirmPassword,onChange:e=>M((0,a._)((0,r._)({},D),{confirmPassword:e.target.value})),required:!0,minLength:"6"}),(0,n.jsx)("button",{type:"button",className:"absolute inset-y-0 right-0 flex items-center pr-3 text-theme-tertiary",onClick:()=>L((0,a._)((0,r._)({},U),{confirm:!U.confirm})),children:U.confirm?(0,n.jsx)(u.Z,{className:"h-5 w-5"}):(0,n.jsx)(x.Z,{className:"h-5 w-5"})})]})]})]}),(0,n.jsx)("div",{className:"mt-6",children:(0,n.jsx)("button",{type:"submit",disabled:E,className:"btn-primary",children:E?"common.changing":"user.changePassword"})})]}),"preferences"===A&&(0,n.jsxs)("form",{onSubmit:z,children:[(0,n.jsx)("h2",{className:"text-xl font-semibold text-theme-primary mb-6",children:"user.preferences"}),(0,n.jsxs)("div",{className:"space-y-8",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-lg font-medium text-theme-primary mb-4",children:"user.notifications"}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("label",{className:"flex items-center",children:[(0,n.jsx)("input",{type:"checkbox",className:"rounded border-theme text-accent shadow-sm focus:border-accent focus:ring-accent",checked:H.emailNotifications,onChange:e=>O((0,a._)((0,r._)({},H),{emailNotifications:e.target.checked}))}),(0,n.jsx)("span",{className:"ml-3 text-sm text-theme-primary",children:"user.emailNotifications"})]}),(0,n.jsxs)("label",{className:"flex items-center",children:[(0,n.jsx)("input",{type:"checkbox",className:"rounded border-theme text-accent shadow-sm focus:border-accent focus:ring-accent",checked:H.orderUpdates,onChange:e=>O((0,a._)((0,r._)({},H),{orderUpdates:e.target.checked}))}),(0,n.jsx)("span",{className:"ml-3 text-sm text-theme-primary",children:"user.orderUpdates"})]}),(0,n.jsxs)("label",{className:"flex items-center",children:[(0,n.jsx)("input",{type:"checkbox",className:"rounded border-theme text-accent shadow-sm focus:border-accent focus:ring-accent",checked:H.promotions,onChange:e=>O((0,a._)((0,r._)({},H),{promotions:e.target.checked}))}),(0,n.jsx)("span",{className:"ml-3 text-sm text-theme-primary",children:"user.promotionalEmails"})]})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-lg font-medium text-theme-primary mb-4",children:"user.language"}),(0,n.jsx)("div",{className:"max-w-xs",children:(0,n.jsx)("select",{className:"form-input bg-theme-input text-theme-primary border-theme focus:ring-accent focus:border-accent",value:H.language,onChange:e=>O((0,a._)((0,r._)({},H),{language:e.target.value})),children:[{code:"en",name:"English"},{code:"fr",name:"Fran\xe7ais"}].map(e=>(0,n.jsxs)("option",{value:e.code,children:[e.flag," ",e.name]},e.code))})})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-lg font-medium text-theme-primary mb-4",children:"user.theme"}),(0,n.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,n.jsxs)("button",{type:"button",onClick:()=>O((0,a._)((0,r._)({},H),{theme:"light"})),className:"flex items-center px-4 py-2 rounded-md border transition-colors ".concat("light"===H.theme?"border-accent bg-accent-light text-accent":"border-theme text-theme-secondary hover:bg-theme-tertiary"),children:[(0,n.jsx)(p.Z,{className:"w-5 h-5 mr-2"}),"theme.light"]}),(0,n.jsxs)("button",{type:"button",onClick:()=>O((0,a._)((0,r._)({},H),{theme:"dark"})),className:"flex items-center px-4 py-2 rounded-md border transition-colors ".concat("dark"===H.theme?"border-accent bg-accent-light text-accent":"border-theme text-theme-secondary hover:bg-theme-tertiary"),children:[(0,n.jsx)(f.Z,{className:"w-5 h-5 mr-2"}),"theme.dark"]}),(0,n.jsxs)("button",{type:"button",onClick:()=>O((0,a._)((0,r._)({},H),{theme:"system"})),className:"flex items-center px-4 py-2 rounded-md border transition-colors ".concat("system"===H.theme?"border-accent bg-accent-light text-accent":"border-theme text-theme-secondary hover:bg-theme-tertiary"),children:[(0,n.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"theme.system"]})]})]})]}),(0,n.jsx)("div",{className:"mt-8",children:(0,n.jsx)("button",{type:"submit",disabled:E,className:"btn-primary",children:E?"common.saving":"common.save"})})]})]})})})]})]})})]}):null}}},function(e){e.O(0,[216,888,179],function(){return e(e.s=9657)}),_N_E=e.O()}]);