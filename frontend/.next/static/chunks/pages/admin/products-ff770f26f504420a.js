(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[209],{2678:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/products",function(){return t(7469)}])},8281:function(e,r,t){"use strict";var a=t(567),s=t(4932),o=t(5893),n=t(7294);t(4410);var c=t(9761),i=t(5675),d=t.n(i);r.Z=e=>{var r;let{product:t,categories:i,onClose:l,onSubmit:u}=e,[m,g]=(0,n.useState)({name:(null==t?void 0:t.name)||"",description:(null==t?void 0:t.description)||"",sku:(null==t?void 0:t.sku)||"",price:(null==t?void 0:t.price)||"",compareAtPrice:(null==t?void 0:t.compareAtPrice)||"",stock:(null==t?void 0:t.stock)||"",categoryId:(null==t?void 0:t.categoryId)||"",status:(null==t?void 0:t.status)||"draft",tags:(null==t?void 0:null===(r=t.tags)||void 0===r?void 0:r.join(", "))||"",weight:(null==t?void 0:t.weight)||"",dimensions:(null==t?void 0:t.dimensions)||"",images:(null==t?void 0:t.images)||[]}),[p,x]=(0,n.useState)({}),[b,h]=(0,n.useState)(!1),[f,y]=(0,n.useState)(!1),[j,v]=(0,n.useState)(""),[k,N]=(0,n.useState)(!1),{showSuccess:w,showError:C}=(0,c.V)();(0,n.useEffect)(()=>{if(t){var e;g({name:t.name||"",description:t.description||"",sku:t.sku||"",price:t.price||"",compareAtPrice:t.compareAtPrice||"",stock:t.stock||"",categoryId:t.categoryId||"",status:t.status||"draft",tags:(null===(e=t.tags)||void 0===e?void 0:e.join(", "))||"",weight:t.weight||"",dimensions:t.dimensions||"",images:t.images||[]})}},[t]);let P=e=>{let{name:r,value:t}=e.target;g(e=>(0,s._)((0,a._)({},e),{[r]:t})),p[r]&&x(e=>(0,s._)((0,a._)({},e),{[r]:""}))},_=async()=>{if(!j.trim()){C("Category name is required");return}N(!0);try{let e=await fetch("".concat("https://fenkparet-backend.onrender.com","/api/admin/categories"),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token")),"Content-Type":"application/json"},body:JSON.stringify({name:j.trim(),slug:j.trim().toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"")})});if(!e.ok)throw Error("Failed to create category");let r=await e.json();w("Category created successfully"),i.push(r),g(e=>(0,s._)((0,a._)({},e),{categoryId:r.id})),v(""),y(!1)}catch(e){console.error("Error creating category:",e),C("Failed to create category. Please try again.")}finally{N(!1)}},S=async e=>{let r=Array.from(e.target.files);if(0!==r.length)try{h(!0);let e=r.map(async e=>{let r=new FormData;r.append("image",e);let t=await fetch("".concat("https://fenkparet-backend.onrender.com","/api/admin/upload"),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:r});if(!t.ok)throw Error("Failed to upload image");return(await t.json()).url}),t=await Promise.all(e);g(e=>(0,s._)((0,a._)({},e),{images:[...e.images,...t]})),w("Images uploaded successfully")}catch(e){console.error("Error uploading images:",e),C("Failed to upload images. Please try again.")}finally{h(!1)}},I=e=>{g(r=>(0,s._)((0,a._)({},r),{images:r.images.filter((r,t)=>t!==e)}))},E=()=>{let e={};return m.name.trim()||(e.name="Product name is required"),m.sku.trim()||(e.sku="SKU is required"),(!m.price||0>=parseFloat(m.price))&&(e.price="Valid price is required"),(!m.stock||0>parseInt(m.stock))&&(e.stock="Valid stock quantity is required"),m.categoryId||(e.categoryId="Category is required"),x(e),0===Object.keys(e).length},A=async e=>{if(e.preventDefault(),E())try{h(!0);let e=(0,s._)((0,a._)({},m),{price:parseFloat(m.price),compareAtPrice:m.compareAtPrice?parseFloat(m.compareAtPrice):null,stock:parseInt(m.stock),weight:m.weight?parseFloat(m.weight):null,tags:m.tags.split(",").map(e=>e.trim()).filter(e=>e)}),r=t?"".concat("https://fenkparet-backend.onrender.com","/api/admin/products/").concat(t.id):"".concat("https://fenkparet-backend.onrender.com","/api/admin/products");if(!(await fetch(r,{method:t?"PUT":"POST",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token")),"Content-Type":"application/json"},body:JSON.stringify(e)})).ok)throw Error("Failed to ".concat(t?"update":"create"," product"));w("Product ".concat(t?"updated":"created"," successfully")),u()}catch(e){console.error("Error saving product:",e),C("Failed to ".concat(t?"update":"create"," product. Please try again."))}finally{h(!1)}};return(0,o.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,o.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-11/12 md:w-4/5 lg:w-3/4 xl:w-2/3 shadow-lg rounded-md bg-white max-h-[80vh] overflow-y-auto",children:(0,o.jsxs)("div",{className:"mt-3",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,o.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:t?"Edit Product":"Add New Product"}),(0,o.jsx)("button",{type:"button",onClick:l,className:"text-gray-400 hover:text-gray-600",children:(0,o.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,o.jsxs)("form",{onSubmit:A,className:"space-y-6",children:[(0,o.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,o.jsxs)("div",{className:"space-y-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Product Name *"}),(0,o.jsx)("input",{type:"text",name:"name",value:m.name,onChange:P,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent ".concat(p.name?"border-red-300":"border-gray-300"),placeholder:"Enter product name"}),p.name&&(0,o.jsx)("p",{className:"text-red-500 text-xs mt-1",children:p.name})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,o.jsx)("textarea",{name:"description",value:m.description,onChange:P,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter product description"})]}),(0,o.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"SKU *"}),(0,o.jsx)("input",{type:"text",name:"sku",value:m.sku,onChange:P,className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent ".concat(p.sku?"border-red-300":"border-gray-300"),placeholder:"Enter SKU"}),p.sku&&(0,o.jsx)("p",{className:"text-red-500 text-xs mt-1",children:p.sku})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Stock Quantity *"}),(0,o.jsx)("input",{type:"number",name:"stock",value:m.stock,onChange:P,min:"0",className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent ".concat(p.stock?"border-red-300":"border-gray-300"),placeholder:"0"}),p.stock&&(0,o.jsx)("p",{className:"text-red-500 text-xs mt-1",children:p.stock})]})]}),(0,o.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Price *"}),(0,o.jsx)("input",{type:"number",name:"price",value:m.price,onChange:P,min:"0",step:"0.01",className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent ".concat(p.price?"border-red-300":"border-gray-300"),placeholder:"0.00"}),p.price&&(0,o.jsx)("p",{className:"text-red-500 text-xs mt-1",children:p.price})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Compare at Price"}),(0,o.jsx)("input",{type:"number",name:"compareAtPrice",value:m.compareAtPrice,onChange:P,min:"0",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0.00"})]})]})]}),(0,o.jsxs)("div",{className:"space-y-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category *"}),(0,o.jsxs)("div",{className:"flex gap-2",children:[(0,o.jsxs)("select",{name:"categoryId",value:m.categoryId,onChange:P,className:"flex-1 px-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent ".concat(p.categoryId?"border-red-300":"border-gray-300"),children:[(0,o.jsx)("option",{value:"",children:"Select a category"}),i.map(e=>(0,o.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,o.jsx)("button",{type:"button",onClick:()=>y(!f),className:"px-3 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 whitespace-nowrap",children:"+ New"})]}),f&&(0,o.jsx)("div",{className:"mt-2 p-3 border border-gray-200 rounded-md bg-gray-50",children:(0,o.jsxs)("div",{className:"flex gap-2",children:[(0,o.jsx)("input",{type:"text",value:j,onChange:e=>v(e.target.value),placeholder:"Enter new category name",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",onKeyPress:e=>"Enter"===e.key&&_()}),(0,o.jsx)("button",{type:"button",onClick:_,disabled:k,className:"px-3 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:ring-2 focus:ring-green-500 focus:ring-offset-2 disabled:opacity-50",children:k?"Creating...":"Create"}),(0,o.jsx)("button",{type:"button",onClick:()=>{y(!1),v("")},className:"px-3 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 focus:ring-2 focus:ring-gray-500 focus:ring-offset-2",children:"Cancel"})]})}),p.categoryId&&(0,o.jsx)("p",{className:"text-red-500 text-xs mt-1",children:p.categoryId})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,o.jsxs)("select",{name:"status",value:m.status,onChange:P,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,o.jsx)("option",{value:"draft",children:"Draft"}),(0,o.jsx)("option",{value:"active",children:"Active"}),(0,o.jsx)("option",{value:"inactive",children:"Inactive"})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tags"}),(0,o.jsx)("input",{type:"text",name:"tags",value:m.tags,onChange:P,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"tag1, tag2, tag3"}),(0,o.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Separate tags with commas"})]}),(0,o.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Weight (kg)"}),(0,o.jsx)("input",{type:"number",name:"weight",value:m.weight,onChange:P,min:"0",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0.00"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Dimensions"}),(0,o.jsx)("input",{type:"text",name:"dimensions",value:m.dimensions,onChange:P,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"L x W x H"})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Product Images"}),(0,o.jsx)("input",{type:"file",multiple:!0,accept:"image/*",onChange:S,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),m.images.length>0&&(0,o.jsx)("div",{className:"mt-2 grid grid-cols-3 gap-2",children:m.images.map((e,r)=>(0,o.jsxs)("div",{className:"relative",children:[(0,o.jsx)(d(),{src:e,alt:"Product ".concat(r+1),width:80,height:80,className:"w-full h-20 object-cover rounded border"}),(0,o.jsx)("button",{type:"button",onClick:()=>I(r),className:"absolute -top-1 -right-1 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs hover:bg-red-600",children:"\xd7"})]},r))})]})]})]}),(0,o.jsxs)("div",{className:"flex justify-end space-x-3 pt-6 border-t",children:[(0,o.jsx)("button",{type:"button",onClick:l,className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",disabled:b,children:"Cancel"}),(0,o.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md text-sm font-medium hover:bg-blue-700 disabled:opacity-50",disabled:b,children:b?"Saving...":t?"Update Product":"Create Product"})]})]})]})})})}}},function(e){e.O(0,[328,58,216,888,179],function(){return e(e.s=2678)}),_N_E=e.O()}]);